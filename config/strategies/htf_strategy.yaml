# HTF (Higher Time Frame) Strategy Configuration
# Multi-timeframe: HTF for bias, LTF for entries

# ===== INSTRUMENT SETTINGS =====
symbol: "ES"
tick_size: 0.25
tick_value: 12.50  # ES = $12.50, NQ = $5.00
contracts: 3

# ===== TIMEFRAME SETTINGS =====
timeframes:
  htf: "15m"    # Higher timeframe for bias & levels
  ltf: "3m"     # Lower timeframe for entries

# ===== HTF ANALYSIS =====
htf_analysis:
  # Trend detection (EMA crossover)
  ema_fast: 20
  ema_slow: 50

  # Swing point detection for S/R levels
  swing_lookback: 5

  # Level merging tolerance
  level_tolerance_ticks: 8

# ===== ENTRY CONDITIONS =====
entry:
  # Distance from key level to consider "testing"
  level_tolerance_ticks: 8

  # Stop placement beyond key level
  stop_buffer_ticks: 4

  # Minimum risk/reward ratio
  min_rr_ratio: 2.0

  # Entry patterns
  patterns:
    bullish:
      - "bull_engulfing"
      - "hammer"
      - "bull_rejection"
    bearish:
      - "bear_engulfing"
      - "shooting_star"
      - "bear_rejection"

# ===== HYBRID FILTER SYSTEM (V10.8) =====
# 2 mandatory + 2/3 optional filters for better win rate
filters:
  # MANDATORY (both must pass)
  mandatory:
    di_direction: true    # +DI > -DI for LONG, -DI > +DI for SHORT

  # OPTIONAL (2 of 3 must pass)
  optional:
    displacement_threshold: 1.0   # >= 1.0x average body
    min_adx: 11                   # ADX >= 11
    ema_alignment: true           # EMA20 vs EMA50 trend alignment

  # Override: 3x displacement allows ADX >= 10
  high_displacement_override: 3.0
  high_displacement_min_adx: 10

# ===== EXIT CONDITIONS =====
exit:
  # Fixed target based on R multiple
  target_r: 2.0

  # OR target at next HTF level (whichever is closer)
  use_htf_level_target: true

  # Trailing stop (optional)
  use_trailing_stop: false
  trail_activation_r: 1.5
  trail_distance_ticks: 4

# ===== RISK MANAGEMENT =====
risk:
  max_losses_per_day: 2
  max_daily_loss_dollars: 500

# ===== SESSION FILTER =====
session:
  # Trading hours (EST)
  start: "04:00"
  end: "16:00"

  # Optional killzones
  require_killzone: false
  killzones:
    NY_OPEN:
      start: "09:30"
      end: "11:00"
    NY_PM:
      start: "13:30"
      end: "15:00"

# ===== BACKTEST SETTINGS =====
backtest:
  days: 14
  initial_capital: 50000
  commission_per_contract: 2.50
